#!/usr/bin/env bash

# Check if Nginx is installed
if ! command -v nginx &> /dev/null; then
    echo "Nginx is not installed. Installing..."
    sudo apt-get update
    sudo apt-get install nginx -y
else
    echo "Nginx is already installed."
fi

# Check if Nginx is listening on port 80
if sudo netstat -tuln | grep -q ":80 "; then
    echo "Nginx is already listening on port 80."
else
    echo "Configuring Nginx to listen on port 80..."
    sudo tee /etc/nginx/sites-available/default <<EOF
server {
    listen 80 default_server;
    listen [::]:80 default_server;

    root /var/www/html;
    server_name _;

    location / {
        try_files \$uri \$uri/ =404;
    }
}
EOF

    # Test Nginx configuration
    sudo nginx -t

    # Reload Nginx to apply the changes
    sudo systemctl reload nginx

    echo "Nginx is now listening on port 80."
fi
